\subsection{Intégrale d'une fonction mesurable positive}


On travaille avec $(E,\triA,\mu)$ un espace mesuré.

\begin{definition}[Fonction étagée]
	Soit $f: (E, \triA) \to (\R, \bor(\R))$ une fonction mesurable. On dit que $f$ est une fonction étagée
	si elle prend un nombre fini de valeurs.
	Si $\alpha_1, \dots, \alpha_n$ sont les valeurs prises par $f$, on note
	$A_i = f^{-1}(\{\alpha_i\})$ et on a
	$$ f = \sum_{i=1}^n \alpha_i \1_{A_i} $$
	on dit que c'est \textbf{l'écriture canonique} de $f$.
\end{definition}

\begin{remarque}
	$\1_{\Q}$ est étagée mais pas en escalier.
\end{remarque}


\begin{definition}[Intégrale d'une fonction étagée positive]
	Si $f = \sum\limits_{i=1}^n \alpha_i \1_{A_i}$ est une fonction étagée positive, on définit
	$$ \int f d\mu = \sum_{i=1}^n \alpha_i \mu(A_i) \in [0, +\infty] $$
	Avec la convention $0 \cdot \infty = 0$.
\end{definition}


\begin{remarque}
	La valeur de $\int f d\mu$ ne dépend pas de l'écriture canonique de $f$, i.e. si
	$$ f = \sum_{i=1}^n \alpha_i \1_{A_i} = \sum_{j=1}^m \beta_j \1_{B_j} $$
	alors
	$$ \sum_{i=1}^n \alpha_i \mu(A_i) = \sum_{j=1}^m \beta_j \mu(B_j) $$
\end{remarque} %TODO: Add proof ?

\begin{prop}[Linéarité et croissance]
	Soient $f,g$ deux fonctions étagées positives.
	\begin{enumerate}
		\item $  \forall a, b \in \R, \int (af + bg) d\mu = a \int f d\mu + b \int g d\mu$
		\item Si $f \leq g$ alors $\int f d\mu \leq \int g d\mu$
	\end{enumerate}
\end{prop}

\begin{proof}
	\begin{itemize}
		\item $ f = \sum_{i=1}^n \alpha_i \1_{A_i} $ et $ g = \sum_{j=1}^m \alpha'_j \1_{A'_j} $
		      On introduit $B_{ij} = A_i \cap A'_j$, $\beta_{ik} = \alpha_i$ et $\beta'_{ik} = \alpha'_k$.
		      On a alors
		      $$ f = \sum_{i=1}^n \sum_{j=1}^m \beta_{ij} \1_{B_{ij}}, \ \int f \mu = \sum_{i,j} \beta_{ij} \mu(B_{ij}) $$
		      et
		      $$ g = \sum_{i=1}^n \sum_{j=1}^m \beta'_{ij} \1_{B_{ij}}, \ \int g \mu = \sum_{i,j} \beta'_{ij} \mu(B_{ij} $$
		      On a alors
		      \begin{eqnarray*}
			      \int (af + bg) d\mu & = & \int \left( \sum_{i=1}^n \sum_{j=1}^m (a\beta_{ij} + b\beta'_{ij}) \1_{B_{ij}} \right) d\mu \\
			      & = & \sum_{i,j} (a\beta_{ij} + b\beta'_{ij}) \mu(B_{ij}) \\
			      & = & a \sum_{i,j} \beta_{ij} \mu(B_{ij}) + b \sum_{i,j} \beta'_{ij} \mu(B_{ij}) \\
			      & = & a \int f d\mu + b \int g d\mu
		      \end{eqnarray*}
		\item Si $f \leq g$ alors $g - f $ est étagée positive.
		      \begin{eqnarray*}
			      \int g d\mu & = & \int (f + (g-f)) d\mu \\
			      & = & \int f d\mu + \underbrace{\int (g-f)}_{\geq 0} d\mu
		      \end{eqnarray*}
		      Donc $\int g d\mu \geq \int f d\mu$.
	\end{itemize}
\end{proof}

\begin{notation}
	On note $\mathcal{E}_+$ l'ensemble des fonctions étagées positives.
\end{notation}

\begin{definition}[Intégrale d'une fonction mesurable positive]
	Soit $f: (E, \triA) \to (\Rbarp, \bor(\Rbarp))$ une fonction mesurable positive.
	On définit
	$$ \int f d\mu = \sup\limits_{\substack{g \in \mathcal{E}_+ \\ g \leq f}} \int g d\mu $$
\end{definition}

\begin{remarque}
	L'ensemble en question n'est pas vide car $0 \in \mathcal{E}_+$ et $0 \leq f$. Et donc
	$$ \int f d\mu \geq \int 0 \ d\mu = 0 $$
\end{remarque}

\begin{remarque}
	Si $g$ est étagée positive,
	$$\sup\limits_{\substack{h \in \mathcal{E}_+ \\ h \leq g}} \int h d\mu \leq \int g d\mu \text{ intégrale définie précédemment}$$
	et de plus $h \in \mathcal{E}_+$ et $h \leq g$ et donc
	$$ \int g d\mu \leq \sup\limits_{\substack{h \in \mathcal{E}_+ \\ h \leq g}} \int h d\mu $$
	et donc on a l'égalité entre les deux définitions.
\end{remarque}

\begin{remarque}
	On notera:
	\begin{itemize}
		\item $\int f d\mu$
		\item $\int f(x) d\mu(x)$
		\item $\int f(x) \mu(dx)$
		\item $\int\limits_E f(x) \mu(dx)$
		\item $\int\limits_{x\in E} f(x) d\mu(x)$
		\item Et même $\mu(f)$
	\end{itemize}
\end{remarque}


\begin{prop}[Croissance et séparation] \label{prop:croi-et-sep}
	\begin{itemize}
		\item Si $f,g$ mesurables positives $f \leq g$ alors $\int f d\mu \leq \int g d\mu$
		\item Si $\mu(\left\{x : f(x) > 0\right\}) = 0$ alors $\int f d\mu = 0$
	\end{itemize}
\end{prop}

\begin{proof}
	\begin{itemize}
		\item $\left\{ h \in \mathcal{E}_+ : h \leq f \right\} \subset \left\{ h \in \mathcal{E}_+ : h \leq g \right\}$ donc
		      $$ \int f d\mu \leq \int g d\mu $$
		\item Soit $h$ étagée positive telle que $h \leq f$.
		      $h^{-1}(\overline{\R^{+*}}) \subset f^{-1}(\overline{\R^{+*}})$ et donc
		      $$ \mu(h^{-1}(\overline{\R^{+*}})) \leq \mu(f^{-1}(\overline{\R^{+*}})) = 0 $$
		      Donc $h = 0 \cdot \1_{A_i} + \sum_{j=1}^n \alpha_j \1_{A_j}$
		      Alors $A_i \subset h^{-1}(\{0\})$ et donc $\mu(A_i) = 0$.
		      Donc $\int h d\mu = 0$.
		      et donc $\int f d\mu = 0$.
	\end{itemize}
\end{proof}


\begin{theorem}[Convergence monotone] \label{thm:convergence_monotone}
	Soit $(f_n)_{n \in \N}$ une suite croissante de fonctions mesurables positives.\\
	On note $f = \lim\limits_{n \to \infty}\uparrow f_n$.
	Alors on a
	$$ \int f d\mu = \lim\limits_{n \to \infty} \int f_n d\mu $$
\end{theorem}

\begin{remarque}
	$f_n$ suite croissante de fonctions (et pas suite de fonctions croissantes ...).
	$$ \forall n \in \N, f_n \leq f_{n+1} $$
\end{remarque}


\begin{proof}
	\begin{itemize}
		\item $$f_n (x) \leq f_{n+1}(x)$$ et donc $\int f_n d\mu \leq \int f_{n+1} d\mu$.
		      et finalement $$\lim\limits_{n \to \infty} \int f_n d\mu \leq \int f d\mu$$.
		\item Soit $h \in \mathcal{E}_+$ telle que $h \leq f$, montrons que $\int h d\mu \leq \lim\limits_{n \to \infty} \int f_n d\mu$.\\
		      Soit $a \in [0,1[$
		      $$ E_n = \left\{ x \in E :  ah(x) \leq f_n(x) \right\} $$
		      $E_n$ est mesurable car $E_n = (ah-f_n)^{-1}(\R^-)$.\\
		      On a $f_n \to f$ et donc $a < 1$ et donc $ah < f$ et donc pour un
		      $n$ assez grand, $f_n \geq ah$.\\
		      Donc $E = \bigcup_{n \in \N} E_n$.\\
		      Or $ f_n \geq ah \1_{E_n} $ et donc
		      \begin{eqnarray*}
			      \int f_n d\mu \geq \int ah \1_{E_n} d\mu &=& \sum_{i=1}^k a \alpha_i \mu (A_i \cap E_n) \\
			      \text{car } ah\1_{E_n} = \sum_{i=1}^k a \alpha_i \1_{A_i \cap E_n} \  \text{est étagée positive} &=& a \sum_{i=1}^k \alpha_i \mu(A_i \cap E_n) \\
		      \end{eqnarray*}
		      or $E_n$ est une suite croissante d'ensembles avec $\bigcup_{n \in \N} E_n = E$ et donc
		      \begin{eqnarray*}
			      \lim\limits_{n \to \infty} \mu(A_i \cap E_n) &=& \mu(A_i)\\
			      \lim \limits_{n \to \infty} \int f_n d\mu &\geq& a \int h d\mu
		      \end{eqnarray*}
		      Comme c'est vrai pour tout $a \in [0,1[$, on a
		      \begin{eqnarray*}
			      \lim \limits_{n \to \infty} \int f_n d\mu &\geq&  \int h d\mu\\
			      \lim \limits_{n \to \infty} \int f_n d\mu &\geq& \sup\limits_{\substack{h \in \mathcal{E}_+ \\ h \leq f}} \int h d\mu = \int f d\mu
		      \end{eqnarray*}
	\end{itemize}
\end{proof}


\begin{example}[Contre-exemple à la convergence monotone pour une suite non croissante]
	$$f_n = \1_{[n, \infty[}$$
	$$f_n \to 0, \ \forall x$$
	Et on a  $\int f_n d\lambda = \infty$ or $\int 0 d\lambda = 0$.
\end{example}

\begin{prop}
	Soit $f$ mesurable positive.\\
	Alors il existe $f_n$ suite croissante de fonctions étagées positives telles que
	$$\forall x \in E, f_n(x) \to f(x)$$
\end{prop}


\begin{proof} %TODO: Add graphics
	$$n \geq 1, i \in \left\{0, \dots, 2^n - 1\right\}$$
	\begin{eqnarray*}
		A_{n} &=& \left\{ x \in E : f(x) \geq n \right\} \in \triA \\
		B_{n,i} &=& \left\{ x \in E : \frac{i}{2^n} \leq f(x) < \frac{i+1}{2^n} \right\} \in \triA \\
		f_n & = & n \1_{A_n} + \sum_{i=0}^{2^n - 1} \frac{i}{2^n} \1_{B_{n,i}}
	\end{eqnarray*}

	En général, $A_n$ et $B_{n,i}$ ne sont pas des intervalles.

	Par construction $f_n \leq fn$ et $f_n$ est une suite croissante, c'est pour cette raison qu'on a subdivisé avec $2^n$ intervalles, et pas $n$ intervalles.\\
	A-t-on $f_n \to f$ ?

	\begin{eqnarray*}
		f_n(x) =  2^{-1} i_n(x)\underbrace{\1_{B_n,i_n(x)}(x)}_{=1} &\text{ Si } \1_n(x) \text{ est tel que } x \in B_{n,i_n(x)} & \\
		& 2^{-n}i_n(x) \leq f_n(x) \leq 2^{-n}(i_n(x) + 1) &\\
		& \text{donc } 2_{-n}i_n(x) \to f(x) &
	\end{eqnarray*}
	Et donc $f_n(x) \to f(x)$
\end{proof}

\begin{remarque}
	Les fonctions données par la proposition précédente vérifient les hypothèses du théorème \ref{thm:convergence_monotone}, donc
	$$ \int f_n d\mu \to \int f d\mu $$
\end{remarque}


\begin{prop}[Linéarité]
	Soient $f,g$ mesurables positives et $a, b\geq 0$.
	$$ \int (af + bg) d\mu = a\int f d\mu + b\int g d\mu $$
\end{prop}


\begin{proof}
	$$f_n \in \mathcal{E}_+, f_n \uparrow \to f$$
	$$ g_n \in \mathcal{E}_+, g_n \uparrow \to g$$
	$$ \underbrace{\int a f_n + b g_n \,d\mu}_{\text{Par } \ref{thm:convergence_monotone} \to \int a f + b g\,d\mu}
		= a \underbrace{\int f_n d\mu}_{ \text{Par } \ref{thm:convergence_monotone} \to \int f d\mu}
		+ b \underbrace{\int g_n d\mu}_{ \text{Par } \ref{thm:convergence_monotone} \to \int g d\mu} $$
\end{proof}



\begin{prop} [TCM pour les suites]
	Soit $f_n$ une suite de fonctions mesurables positives.\\
	Alors,
	$$ \int \sum\limits_n^{\infty} f_n d\mu = \sum\limits_n^{\infty} \int f_n d\mu $$
\end{prop}

\begin{proof}
	On regarde $S_n(x) = \sum\limits_{k=1}^n f_k(x)$ est une suite de fonctions mesurables positives.
	Et $S_{n+1} - S_n = f_{n+1} > 0 $ et donc $S_n$ est une suite croissante de fonctions mesurables positives.
	D'après le \ref{thm:convergence_monotone}, on a
	\begin{eqnarray*}
		\int \lim\limits_{n \to \infty} S_n (x)d\mu (x)&=& \lim\limits_{n \to \infty} \int S_n(x) d\mu(x) \\
		\int \sum\limits_{n = 1}^{\infty} S_n (x)d\mu (x)&=& \lim\limits_{n \to \infty} \int \sum\limits_{k = 1}^n f_k(x) d\mu(x) \\
		&=& \lim\limits_{n \to \infty} \sum\limits_{k = 1}^n\int  f_k(x) d\mu(x) \\
		&=& \sum\limits_{n = 1}^{\infty} \int  f_k(x) d\mu(x) \\
	\end{eqnarray*}
\end{proof}


\begin{definition}[$\mu$-presque partout]
	Soit $P$ une propriété sur $x \in E$ ($P(x) \in \{Vrai, Faux\}$)\\
	On dit que $P$ est vraie $\mu$-presque partout ($\mupp$) si
	$$ \left\{x \in E : P(x)  = Faux \right\} \in \triA \text{ et } \mu\left(\left\{x \in E : P(x)  = Faux \right\}\right) = 0 $$
	ou s'il existe $B \in \triA$ tel que $\left\{ x \in E : P(x) = Faux \right\} \subset B$ et $\mu(B) = 0$
\end{definition}

\begin{definition}[Mesure à densité]
	Soit $f$ une fonction mesurable positive. \\
	On définit
	\begin{eqnarray*}
		\nu : \triA & \to &\Rbarp                  \\
		A     & \mapsto & \int \1_A f d\mu \\
		&& = \int_A fd\mu
	\end{eqnarray*}
	Alors $\nu$ est une mesure sur $(E, \triA)$ et on l'appelle mesure à densité par rapport à $\mu$.
\end{definition}

\begin{proof}
	\begin{itemize}
		\item L'ensemble de départ est mesurable.
		\item $\nu(\emptyset) = \int \1_{\emptyset} f d\mu = \int 0 d \mu = 0$
		\item $A_n$ suite d'ensembles disjoints, on regarde
		      \begin{eqnarray*}
			      \nu\left(\bigcup A_n\right) &=& \int \1_{\bigcup A_n} f d\mu \\
			      &=& \int \left( \sum_{k=1}^{\infty} \1_{A_k} \right) f d\mu \\
			      &=& \int \sum_{k=1}^{\infty} \1_{A_k} f d\mu \\
			      &=& \sum_{k=1}^{\infty} \int \1_{A_k} f d\mu
		      \end{eqnarray*}
		      d'après le TCM pour les séries, car $\forall k \geq 1, \ \1_{A_k}f$ est mesurable positive.
	\end{itemize}
\end{proof}

\begin{remarque} \label{rem:transfert}
	On veut, pour $g$ mesurable positive, montrer que
	$$ \int g d\nu = \int g f d\mu $$
\end{remarque}

\begin{proof}
	\begin{itemize}
		\item Vrai pour $\1_A$ ?
		\item Vrai pour $g$ étagée positive ?
		\item Vrai pour  $g$ étagée positive ?
	\end{itemize}

	\begin{itemize}
		\item Si $g = \1_A$, avec $A \in \mathscr{F}$, alors
		      \begin{eqnarray*}
			      \int g d \nu &=& \int \1_A d\nu  = \nu(A) \\
			      &=& \int \1_A f d\mu = \int g f d\mu
		      \end{eqnarray*}
		\item Si $g = \sum_{i=1}^n \alpha_i \1_{A_i}$, alors
		      \begin{eqnarray*}
			      \int g d \nu = \sum_{i=1}^n \alpha_i \1_{A_i} \nu(A_i)  &=& \sum_{i=1}^n \alpha_i \int f \1_{A_i} d \mu \\
			      &=&\int \left(\sum_{i=1}^n \alpha_i \1_{A_i}\right) f d \mu \\
			      &=& \int g f d \mu
		      \end{eqnarray*}
		\item Si $g$ est étagée positive, alors
		      On prend $g_n \uparrow g$ une suite de fonctions étagées positives.
		      Alors \begin{eqnarray*}
			      \int g d \nu &=& \lim\limits_{n \to \infty} \int g_n d \nu  \text{ par le théorème \ref{thm:convergence_monotone}}\\
			      &=& \lim\limits_{n \to \infty} \int g_n f d \mu
		      \end{eqnarray*}
		      On remarque que $g_n f$ est une suite croissante de fonctions mesurables positives et donc
		      on peut appliquer le théorème \ref{thm:convergence_monotone} et donc
		      \begin{eqnarray*}
			      \lim\limits_{n \to \infty} \int g_n f d \mu & = & \int  \lim\limits_{n \to \infty} g_n f d \mu \\
			      &=& \int g f d \mu
		      \end{eqnarray*}
	\end{itemize}
\end{proof}

\begin{example}[loi normale sur $\R$]
	(Même proba sur  $(\R, \bor(\R))$, qui est la loi de $X ~ \mathscr{N}(0,1)$)
	\begin{eqnarray*}
		\nu(B) = \Pro_\lambda(B) &= &\Pro(X \in B)  \\
		&=& \int \1_B(x) \frac{1}{\sqrt{2\pi}} e^{-\frac{X^2}{2}} d \lambda(x)\\
		&=&\int \1_B f d\lambda
	\end{eqnarray*}

	Donc $\nu$ a la même densité que $f$ par rapport à la mesure de Lebesgue:
	$$f (x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{X^2}{2}} $$
\end{example}




\begin{prop}[Inégalité de Markov]
	Soit $f$ une fonction mesurable positive.
	\begin{itemize}
		\item Pour tout $a > 0$ on a
		      $$ \mu\left(\left\{ x \in E : f(x) \geq a \right\}\right) \leq \frac{1}{a} \int f d\mu $$
		\item Si $\int f d\mu < \infty$ alors $f < \infty \ \mupp$
		\item $\int f d\mu = 0$ si et seulement si $f = 0 \ \mupp$
		\item $f=g \ \mupp \implies \int f d\mu = \int g d\mu$
	\end{itemize}
\end{prop}

\begin{proof}
	\begin{itemize}
		\item $f \geq a \1_{f \geq a}$
		      $$\int f d \mu \geq a \mu \left( \left\{ x \in E : f(x) \geq a \right\} \right) $$
		\item $A_k = \left\{ x \in E : f(x) \geq a \right\}$
		      On a $A_{\infty} = \bigcup_{k=0}^{\infty} A_k$ intersection décroissante.
		      \begin{eqnarray*}
			      \mu(A_1) &=& 1 \int f d \mu \text{ d'après  le (1)}\\
			      &<& \infty \text{ par hypothèse}
		      \end{eqnarray*}
		      donc \begin{eqnarray*}
			      \mu {A_{\infty}} &=& \lim\limits_{n \to \infty} \mu(A_n) \\
			      \mu(A_{n} &\leq& \frac{1}{n} \int f d u
		      \end{eqnarray*}

		      Donc $\mu (An) \to 0$ et donc $\mu(A_{\infty}) = 0$.
		\item $f= 0 \ \mupp \implies \int f d\mu = 0$  par  \ref{prop:croi-et-sep}.\\
		      $\leftarrow$ Soit  $f$ mesurable positive telle que $\int f d\mu = 0$.\\
		      $B_n = \left\{ x \in E : f(x) \geq \frac{1}{n} \right\}$\\
		      $\bigcup B_n$ est une suite croissante. \\
		      $\bigcup\limits_{n \in \N} = \left\{ x \in E : f(x) > 0 \right\}$\\

		      \begin{eqnarray*} %TODO: Add prof
		      \end{eqnarray*}

	\end{itemize}
\end{proof}


\begin{theorem}[Lemme de Fatou]
	Soit $f_n$ est une suite de fonctions mesurables positives.\\
	Alors
	$$ \int \liminf f_n d\mu \leq \liminf \int f_n d\mu $$
\end{theorem}

\begin{proof}
	$\liminf f_n = \lim\limits_{n \to \infty} \uparrow \inf_{k \geq n} f_k$\\
	On regarde $g_n = \inf_{k \geq n} f_k$ est une suite croissante de fonctions mesurables positives.\\
	Donc d'après le théorème \ref{thm:convergence_monotone}, on a
	$$ \lim\limits_{n \to \infty} \int g_n d\mu = \int \lim\limits_{n \to \infty} g_n d\mu = \int \liminf f_n d\mu $$
	Si $p \geq n$, alors $g_n \leq f_p$ et donc
	$$ \int g_n d\mu \leq \int f_p d\mu $$
	et donc
	$$ \forall p \geq n, \int f_p d\mu \geq \int g_n d\mu $$
	Et donc $\forall n \in \N$:
	$$ \inf_{p \geq n} \int f_p d\mu \geq \int g_n d\mu $$
	Et en passant à la limite, on a
	$$ \liminf \int f_n d\mu \geq \int \liminf f_n d\mu $$
\end{proof}


\begin{example} $([0,1], \bor([0,1]),\lambda)$\\
	\begin{eqnarray*}
		f_{2k} &=& \1_{[\frac{1}{2}, 1]}\\
		f_{2k+1} &=& \1_{[0,\frac{1}{2}]}\\
		\liminf f_n &=& \1_{\{\frac{1}{2}\}}\\
		\int f_n d \lambda &=& \frac{1}{2}
	\end{eqnarray*}
	$$ 0 = \int \liminf f_n d \lambda \leq \liminf \int f_n d \lambda = \frac{1}{2} $$
\end{example}


\begin{theorem}[Égalité Riemann-Lebesgue sur un segment, fonctions positives]
	Soit $f$ mesurable positive:
	$ f ([a,b], \bor([a,b])) \to \R, \bor(\R)$.\\
	On suppose $f$ Riemann intégrable sur $[a,b]$.\\
	$$ \int_a^b f(x) dx = \int_{[a,b]} f d\lambda $$
\end{theorem}

\begin{proof}
	%TODO: Add proof
\end{proof}
